# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“¦ GitLab CE with CI/CD - Complete Setup
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ¯ Ù‡Ø¯Ù Ø§ÛŒÙ† Playbook:
#    Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ GitLab Community Edition Ø¨Ø§ CI/CD Runner
#
# âœ… Ú©Ø§Ø±Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯:
#    1. Ù†ØµØ¨ GitLab CE Ø§Ø² repository Ø±Ø³Ù…ÛŒ
#    2. ØªÙ†Ø¸ÛŒÙ… SSL Ø¨Ø§ Let's Encrypt
#    3. ØªÙ†Ø¸ÛŒÙ… Email (SMTP)
#    4. ØªÙ†Ø¸ÛŒÙ… Container Registry
#    5. Ù†ØµØ¨ GitLab Runner Ø¨Ø±Ø§ÛŒ CI/CD
#    6. ØªÙ†Ø¸ÛŒÙ… backup Ø®ÙˆØ¯Ú©Ø§Ø±
#    7. Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ performance
#
# âš ï¸ Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²Ù‡Ø§:
#    - Ø­Ø¯Ø§Ù‚Ù„ 4GB RAM (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ 8GB+)
#    - Ø­Ø¯Ø§Ù‚Ù„ 20GB ÙØ¶Ø§ÛŒ Ø¯ÛŒØ³Ú©
#    - Ø¯Ø§Ù…Ù†Ù‡ Ù…Ø¹ØªØ¨Ø± Ø¨Ø±Ø§ÛŒ SSL
#
# ğŸ“‹ Ù†Ø­ÙˆÙ‡ Ø§Ø¬Ø±Ø§:
#    ansible-playbook -i inventory.yml site.yml --ask-vault-pass
#
# ğŸ” Ù¾Ø³ Ø§Ø² Ù†ØµØ¨:
#    - Root password Ø¯Ø± ÙØ§ÛŒÙ„ /etc/gitlab/initial_root_password
#    - ÛŒØ§: gitlab-rake "gitlab:password:reset[root]"
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

---
all:
  children:
    gitlab_servers:
      hosts:
        gitlab:
          ansible_host: 192.168.1.80
    
    gitlab_runners:
      hosts:
        runner-1:
          ansible_host: 192.168.1.81
          runner_name: docker-runner-1
          runner_executor: docker
          runner_tags:
            - docker
            - linux
        runner-2:
          ansible_host: 192.168.1.82
          runner_name: shell-runner-1
          runner_executor: shell
          runner_tags:
            - shell
            - deploy
  
  vars:
    # GitLab settings
    gitlab_domain: gitlab.example.com
    gitlab_external_url: "https://{{ gitlab_domain }}"
    
    # SSL
    gitlab_ssl_enabled: true
    gitlab_letsencrypt_enabled: true
    gitlab_letsencrypt_email: admin@example.com
    
    # Container Registry
    gitlab_registry_enabled: true
    gitlab_registry_domain: registry.example.com
    
    # Pages (optional)
    gitlab_pages_enabled: false
    gitlab_pages_domain: pages.example.com
    
    # SMTP settings
    gitlab_smtp_enabled: true
    gitlab_smtp_server: smtp.gmail.com
    gitlab_smtp_port: 587
    gitlab_smtp_user: "gitlab@example.com"
    gitlab_smtp_password: "{{ vault_gitlab_smtp_password }}"
    gitlab_smtp_domain: example.com
    gitlab_email_from: "gitlab@example.com"
    gitlab_email_reply_to: "noreply@example.com"
    
    # Performance tuning
    gitlab_puma_workers: 2
    gitlab_sidekiq_concurrency: 10
    gitlab_postgresql_shared_buffers: "256MB"
    
    # Backup settings
    gitlab_backup_enabled: true
    gitlab_backup_path: /var/opt/gitlab/backups
    gitlab_backup_keep_time: 604800  # 7 days in seconds
    
    # Runner settings
    gitlab_runner_token: "{{ vault_gitlab_runner_token }}"
    gitlab_runner_docker_image: "docker:24.0"
