# ๐ฆ Ansible Ad-Hoc Modules Guide

> ุฑุงูููุง ฺฉุงูู ูุงฺููโูุง ูพุฑฺฉุงุฑุจุฑุฏ Ansible ุจุฑุง ุงุฌุฑุง ุฏุณุชูุฑุงุช Ad-Hoc

---

## ๐ ููุฑุณุช ูุทุงูุจ

- [Setup Module](#-setup-module)
- [File Module](#-file-module)
- [Copy Module](#-copy-module)
- [Command Module](#-command-module)
- [Fetch Module](#-fetch-module)

---

## ๐ Setup Module

ูุงฺูู `setup` ุจุฑุง ุฌูุนโุขูุฑ ุงุทูุงุนุงุช (Facts) ุงุฒ ุณุฑูุฑูุง ูุฏู ุงุณุชูุงุฏู ูโุดูุฏ. ุงู ุงุทูุงุนุงุช ุดุงูู ูุดุฎุตุงุช ุณุณุชูโุนุงููุ ุณุฎุชโุงูุฒุงุฑุ ุดุจฺฉู ู... ุงุณุช.

### ุงุณุชูุงุฏู:

```bash
# ููุงุด ุชูุงู ุงุทูุงุนุงุช ุณุณุชู
ansible all -m setup | more

# ููุชุฑ ฺฉุฑุฏู ุงุทูุงุนุงุช ุฎุงุต (ูุซูุงู ุงุทูุงุนุงุช ุญุงูุธู)
ansible all -m setup -a 'filter=ansible_memory_mb'

# ููุท ุงุทูุงุนุงุช ุดุจฺฉู
ansible all -m setup -a 'filter=ansible_eth*'
```

### ุฎุฑูุฌ ุดุงูู:
- `ansible_hostname` - ูุงู ุณุฑูุฑ
- `ansible_os_family` - ุฎุงููุงุฏู ุณุณุชูโุนุงูู
- `ansible_distribution` - ุชูุฒุน ูููฺฉุณ
- `ansible_memory_mb` - ุงุทูุงุนุงุช ุญุงูุธู
- `ansible_processor` - ุงุทูุงุนุงุช ูพุฑุฏุงุฒูุฏู

---

## ๐ File Module

ูุงฺูู `file` ุจุฑุง ูุฏุฑุช ูุงูโูุง ู ุฏุงุฑฺฉุชูุฑโูุง ุงุณุชูุงุฏู ูโุดูุฏ.

### ุงุณุชูุงุฏู:

```bash
# ุงุฌุงุฏ ฺฉ ูุงู ุฎุงู (touch)
ansible all -m file -a 'path=/tmp/test state=touch'

# ุชุบุฑ ุณุทุญ ุฏุณุชุฑุณ ูุงู
ansible all -m file -a 'path=/tmp/test state=file mode=600'

# ุงุฌุงุฏ ุฏุงุฑฺฉุชูุฑ
ansible all -m file -a 'path=/tmp/mydir state=directory mode=755'

# ุงุฌุงุฏ symbolic link
ansible all -m file -a 'src=/tmp/source dest=/tmp/link state=link'

# ุญุฐู ูุงู ุง ุฏุงุฑฺฉุชูุฑ
ansible all -m file -a 'path=/tmp/test state=absent'
```

### ูพุงุฑุงูุชุฑูุง ููู:

| ูพุงุฑุงูุชุฑ | ุชูุถุญ |
|---------|-------|
| `path` | ูุณุฑ ูุงู ุง ุฏุงุฑฺฉุชูุฑ |
| `state` | ูุถุนุช: `touch`, `file`, `directory`, `link`, `absent` |
| `mode` | ุณุทุญ ุฏุณุชุฑุณ (ูุซู `755`, `600`) |
| `owner` | ูุงูฺฉ ูุงู |
| `group` | ฺฏุฑูู ูุงู |

---

## ๐ Copy Module

ูุงฺูู `copy` ุจุฑุง ฺฉูพ ฺฉุฑุฏู ูุงู ุงุฒ ุณุฑูุฑ ฺฉูุชุฑูุฑ ุจู ุณุฑูุฑูุง ูุฏู ุงุณุชูุงุฏู ูโุดูุฏ.

### ุงุณุชูุงุฏู:

```bash
# ฺฉูพ ูุงู ุงุฒ ฺฉูุชุฑูุฑ ุจู ุณุฑูุฑ ูุฏู
ansible all -m copy -a 'src=/tmp/x dest=/tmp/y'

# ฺฉูพ ูุงู ุงุฒ ูุณุฑ ุฏุฑ ุฎูุฏ ุณุฑูุฑ ูุฏู (remote ุจู remote)
ansible all -m copy -a 'remote_src=yes src=/tmp/x dest=/tmp/y'

# ฺฉูพ ุจุง ุชูุธู ุณุทุญ ุฏุณุชุฑุณ
ansible all -m copy -a 'src=/tmp/x dest=/tmp/y mode=644 owner=root'

# ฺฉูพ ูุญุชูุง ูุชู ูุณุชูู
ansible all -m copy -a 'content="Hello World" dest=/tmp/hello.txt'

# ฺฉูพ ุจุง ุงุฌุงุฏ ุจฺฉุงูพ
ansible all -m copy -a 'src=/tmp/x dest=/tmp/y backup=yes'
```

### ูพุงุฑุงูุชุฑูุง ููู:

| ูพุงุฑุงูุชุฑ | ุชูุถุญ |
|---------|-------|
| `src` | ูุณุฑ ูุงู ูุจุฏุง |
| `dest` | ูุณุฑ ูุงู ููุตุฏ |
| `remote_src` | ุงฺฏุฑ `yes` ุจุงุดุฏุ ูุงู ูุจุฏุง ุฏุฑ ุณุฑูุฑ ูุฏู ุงุณุช |
| `mode` | ุณุทุญ ุฏุณุชุฑุณ ูุงู ููุตุฏ |
| `backup` | ุงุฌุงุฏ ุจฺฉุงูพ ูุจู ุงุฒ ุจุงุฒููุณ |
| `content` | ูุญุชูุง ูุชู ุจุฑุง ููุดุชู ุฏุฑ ูุงู |

---

## โก Command Module

ูุงฺูู `command` ูุงฺูู ูพุดโูุฑุถ Ansible ุงุณุช ู ุจุฑุง ุงุฌุฑุง ุฏุณุชูุฑุงุช ุดู ุงุณุชูุงุฏู ูโุดูุฏ.

### ุงุณุชูุงุฏู:

```bash
# ุงุฌุฑุง ุฏุณุชูุฑ ุณุงุฏู (ุฎุฑูุฌ ฺฉโุฎุท ุจุง -o)
ansible all -a 'hostname' -o

# ุงุฌุฑุง ููุท ุงฺฏุฑ ูุงู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ (creates)
ansible all -a 'touch /tmp/test_command_module creates=/tmp/test_command_module'

# ุงุฌุฑุง ููุท ุงฺฏุฑ ูุงู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ (removes)
ansible all -a 'rm /tmp/test_command_module removes=/tmp/test_command_module'

# ุงุฌุฑุง ุฏุณุชูุฑ ุฏุฑ ุฏุงุฑฺฉุชูุฑ ุฎุงุต
ansible all -a 'ls -la' -a 'chdir=/var/log'
```

### ูพุงุฑุงูุชุฑูุง ููู:

| ูพุงุฑุงูุชุฑ | ุชูุถุญ |
|---------|-------|
| `creates` | ุงฺฏุฑ ุงู ูุงู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุฏุณุชูุฑ ุงุฌุฑุง **ููโุดูุฏ** |
| `removes` | ุงฺฏุฑ ุงู ูุงู ูุฌูุฏ **ูุฏุงุดุชู** ุจุงุดุฏุ ุฏุณุชูุฑ ุงุฌุฑุง **ููโุดูุฏ** |
| `chdir` | ูุจู ุงุฒ ุงุฌุฑุง ุจู ุงู ุฏุงุฑฺฉุชูุฑ ุจุฑูุฏ |

> โ๏ธ **ูฺฉุชู:** ูุงฺูู `command` ุงุฒ pipe (`|`) ู redirect (`>`) ูพุดุชุจุงู ููโฺฉูุฏ. ุจุฑุง ุงู ููุงุฑุฏ ุงุฒ ูุงฺูู `shell` ุงุณุชูุงุฏู ฺฉูุฏ.

---

## ๐ฅ Fetch Module

ูุงฺูู `fetch` **ุจุฑุนฺฉุณ** ูุงฺูู `copy` ุนูู ูโฺฉูุฏ. ุนู ูุงู ุฑุง **ุงุฒ ุณุฑูุฑูุง ูุฏู ุจู ุณุฑูุฑ ฺฉูุชุฑูุฑ** ููุชูู ูโฺฉูุฏ.

### ฺฉุงุฑุจุฑุฏ:
- ุฌูุนโุขูุฑ ูุงฺฏโูุง ุงุฒ ุณุฑูุฑูุง
- ุจฺฉุงูพ ฺฏุฑูุชู ุงุฒ ูุงูโูุง ฺฉุงููฺฏ
- ุฌูุนโุขูุฑ ฺฏุฒุงุฑุดโูุง ุงุฒ ฺูุฏู ุณุฑูุฑ

### ุงุณุชูุงุฏู:

```bash
# ุฏุงูููุฏ ูุงู ุงุฒ ุณุฑูุฑูุง ูุฏู ุจู ฺฉูุชุฑูุฑ
ansible all -m fetch -a 'src=/tmp/test_module_test.txt dest=/tmp/' -o

# ุจุง ุณุงุฎุชุงุฑ flat (ุจุฏูู ุงุฌุงุฏ ูููุฏุฑ ุฌุฏุงฺฏุงูู ุจุฑุง ูุฑ ุณุฑูุฑ)
ansible all -m fetch -a 'src=/etc/hostname dest=/tmp/hostnames/ flat=yes'
```

### ุณุงุฎุชุงุฑ ุฎุฑูุฌ ูพุดโูุฑุถ:

```
/tmp/
โโโ server1/
โ   โโโ tmp/
โ       โโโ test_module_test.txt
โโโ server2/
โ   โโโ tmp/
โ       โโโ test_module_test.txt
โโโ server3/
    โโโ tmp/
        โโโ test_module_test.txt
```

### ูพุงุฑุงูุชุฑูุง ููู:

| ูพุงุฑุงูุชุฑ | ุชูุถุญ |
|---------|-------|
| `src` | ูุณุฑ ูุงู ุฏุฑ ุณุฑูุฑ ูุฏู (ููุท ูุงูุ ูู ุฏุงุฑฺฉุชูุฑ) |
| `dest` | ูุณุฑ ููุตุฏ ุฏุฑ ุณุฑูุฑ ฺฉูุชุฑูุฑ |
| `flat` | ุงฺฏุฑ `yes` ุจุงุดุฏุ ุณุงุฎุชุงุฑ ูููุฏุฑ ุงุฌุงุฏ ููโุดูุฏ |
| `fail_on_missing` | ุงฺฏุฑ ูุงู ูุฌูุฏ ูุฏุงุดุชุ ุฎุทุง ุจุฏู |

### ุชูุงูุช Copy ู Fetch:

```
โโโโโโโโโโโโโโโ                    โโโโโโโโโโโโโโโ
โ  Controller โ  โโโโ copy โโโโโถ  โ   Target    โ
โ   Server    โ  โโโโ fetch โโโ   โ   Server    โ
โโโโโโโโโโโโโโโ                    โโโโโโโโโโโโโโโ
```

---

## ๐ฏ ูฺฉุงุช ฺฉู

1. **ูพุฑฺู `-o`**: ุฎุฑูุฌ ุฑุง ุฏุฑ ฺฉ ุฎุท ููุงุด ูโุฏูุฏ
2. **ูพุฑฺู `-b`**: ุจุง sudo ุงุฌุฑุง ูโฺฉูุฏ (become)
3. **ูพุฑฺู `-K`**: ุฑูุฒ sudo ุฑุง ูโูพุฑุณุฏ
4. **ูพุฑฺู `-v`**: ุฎุฑูุฌ ุจุง ุฌุฒุฆุงุช ุจุดุชุฑ

### ูุซุงู ุชุฑฺฉุจ:

```bash
ansible all -m copy -a 'src=/tmp/config dest=/etc/myapp/' -b -K -v
```

---

## ๐ ููุงุจุน ุจุดุชุฑ

- [Ansible Module Index](https://docs.ansible.com/ansible/latest/collections/index_module.html)
- [Ansible Ad-Hoc Commands](https://docs.ansible.com/ansible/latest/user_guide/intro_adhoc.html)
